<% if Rails.env.production? %>
<script async src="https://www.googletagmanager.com/gtag/js?id=<%= ENV['GOOGLE_TRACKING']%>"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', ENV['GOOGLE_TRACKING']);

    document.addEventListener('turbolinks:load', event => {
      if (typeof gtag === 'function') {
        gtag('config', ENV['GOOGLE_TRACKING'], {
          'page_location': event.data.url
        });
      }
    });
  </script>
<% end %>
